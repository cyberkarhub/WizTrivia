/* --- Wiz Trivia Game Styles - Definitive Corrected Version --- */

/* --- Base & Wrapper --- */
html,
body.wiz-trivia-page-context {
    height: 100%;
    margin: 0;
    padding: 0;
    background-color: #1a202c;
    font-family: 'Inter', sans-serif;
    color: #e2e8f0;
    overflow-x: hidden;
}

.trivia-container-wrapper {
    display: flex;
    justify-content: center;
    align-items: flex-start;
    min-height: 100vh;
    padding: 20px 10px; /* Desktop padding */
    box-sizing: border-box;
}

.trivia-container { /* Base for Desktop */
    width: 85%;
    max-width: 900px;
    min-width: 320px;
    margin-left: auto;
    margin-right: auto;
    min-height: 70vh;
    background-color: #2d3748;
    border-radius: 15px;
    border: 2px solid #f34c3e;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5), 0 6px 10px rgba(0,0,0,0.3);
    display: flex;
    flex-direction: column;
    position: relative;
    overflow: hidden;
}

/* --- Utility Classes --- */
.hidden { display: none !important; }

/* --- Game Header --- */
.game-header { width: 100%; background-color: rgba(45, 55, 72, 0.9); padding: 15px 20px; box-sizing: border-box; border-bottom: 1px solid #f34c3e; color: #ffffff; z-index: 9990; position: relative; }
@supports (backdrop-filter: blur(5px)) or (-webkit-backdrop-filter: blur(5px)) { .game-header { backdrop-filter: blur(5px); -webkit-backdrop-filter: blur(5px); } }
.game-header .header-top-row { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; }
.game-header .game-title-area { flex-grow: 1; }
.game-header .game-title { font-size: 1.3rem; font-weight: bold; font-family: "Courier New", Courier, monospace !important; line-height: 1.2; }
.game-header .game-title .orange-text { color: #f34c3e; }
.game-header .signature { font-size: 0.7rem; color: #a0aec0; margin-top: 2px; }
.game-header .signature a { color: #f34c3e; text-decoration: none; }
.game-header .signature a:hover { text-decoration: underline; }
.game-header .header-buttons { display: flex; gap: 8px; margin-left: 10px; }
.game-header .header-buttons button { background-color: transparent; border: 1px solid #f34c3e; color: #f34c3e; padding: 5px 10px; border-radius: 5px; cursor: pointer; font-size: 0.75rem; transition: background-color 0.2s, color 0.2s; }
.game-header .header-buttons button:hover { background-color: #f34c3e; color: #1a202c; }
.game-header .header-buttons button i { margin-right: 4px; }
.header-info-bar { background-color: rgba(26, 32, 44, 0.75); padding: 10px 16px; margin-top: 12px; border-radius: 7px; display: flex; flex-direction: column; gap: 8px; }
.header-info-top, .header-info-bottom { display: flex; justify-content: space-between; align-items: center; width: 100%; }
.level-display, .score-display, .question-progress-display { font-size: 0.8rem; color: #e2e8f0; }
.level-display .level-label, .score-display .score-label { color: #a0aec0; margin-right: 4px; }
#timer-display { font-size: 0.95rem; font-weight: bold; color: #f34c3e; background-color: #1a202c; padding: 7px 12px; border-radius: 5px; display: block; margin-left: auto; margin-right: auto; width: fit-content; margin-top: 8px; }
#lifeline-5050 { background-color: #f34c3e; color: #1a202c; border: none; padding: 6px 9px; border-radius: 5px; font-size: 0.7rem; font-weight: bold; cursor: pointer; }
#lifeline-5050:disabled { background-color: #4a5568; color: #a0aec0; cursor: not-allowed; opacity: 0.7; }
#level-progress-bar-container { width: 100%; height: 8px; background-color: #4a5568; border-radius: 4px; overflow: hidden; margin-top: 8px; }
#level-progress-bar { height: 100%; width: 0%; background-color: #f34c3e; border-radius: 4px; transition: width 0.5s ease-in-out; }

/* --- Main Content Area --- */
.main-content { flex-grow: 1; width: 100%; padding: 20px 25px; box-sizing: border-box; display: flex; flex-direction: column; align-items: center; overflow-y: auto; -ms-overflow-style: none; scrollbar-width: none; padding-bottom: 75px; position: relative; z-index: 5; }
.main-content::-webkit-scrollbar { display: none; }
#game-area.main-content { justify-content: flex-start; padding-top: 15px; }
#preload-screen.main-content { justify-content: center; padding: 25px 30px; padding-bottom: 80px; }

/* --- Question & Options Area --- */
#game-area #question-area { width: 100%; display: flex; flex-direction: column; align-items: center; margin-top: 15px; }
#game-area .question-text { font-size: 1.15rem; font-weight: bold; margin-bottom: 25px; color: #ffffff; text-align: center; width: 100%; max-width: 95%; line-height: 1.4; }
#game-area .options-container { display: grid; grid-template-columns: 1fr; gap: 12px; margin-bottom: 20px; width: 100%; max-width: 400px; margin-left: auto; margin-right: auto; }
.option-button { width: 100%; padding: 12px 18px; border: 1px solid #4a5568; border-radius: 7px; background-color: #2d3748; color: #e2e8f0; font-size: 0.9rem; cursor: pointer; transition: background-color 0.2s ease-in-out, border-color 0.2s ease-in-out, opacity 0.3s, transform 0.1s; text-align: center; font-weight: normal; box-sizing: border-box; text-decoration: none; display: inline-block; }
.option-button:hover:not(:disabled) { background-color: #4a5568; border-color: #718096; transform: translateY(-1px); }
.option-button:active:not(:disabled) { transform: translateY(0px); }
.option-button.correct-answer { background-color: #38a169 !important; border-color: #48bb78 !important; color: white !important; }
.option-button.incorrect-answer { background-color: #e53e3e !important; border-color: #f56565 !important; color: white !important; }
.option-button:disabled { opacity: 0.6; cursor: not-allowed; }
.option-button.hidden-by-lifeline { opacity: 0.4 !important; pointer-events: none !important; background-color: #1a202c !important; }
.option-button.explore-digitrendz-button { border: 2px solid #f34c3e !important; color: #f34c3e !important; background-color: transparent; font-weight: bold; font-family: "Courier New", Courier, monospace; }
.option-button.explore-digitrendz-button:hover { background-color: #f34c3e !important; color: #1a202c !important; }

/* --- Footers --- */
.feedback-footer, .game-footer {
    position: fixed;   /* CHANGED to fixed */
    bottom: 0;
    width: 100%;       /* Will be 100% of viewport width */
    max-width: inherit; /* ADDED: Make it inherit max-width from .trivia-container 
                           so it doesn't go full screen width if game isn't. 
                           This requires .trivia-container to be its offset parent,
                           which might not be the case with position:fixed.
                           Alternative: set max-width explicitly or use JS. */
    /* OR, if you want the footer to always match the container's width dynamically:
       You'll likely need JavaScript to set its width and left position, or nest it differently.
       A simpler CSS-only approach for now is to let it be full viewport width,
       or give it the same max-width as .trivia-container and center it.
    */

    /* Simpler approach for fixed footer width matching container: */
    /* We'll make the footer full width, but its *content* will be constrained */
    /* Remove max-width: inherit; for now */

    padding: 12px 18px;
    box-sizing: border-box;
    /* border-radius: 0; /* Fixed elements usually don't have border-radius matching a parent */
                       /* Or, if you want to keep the rounded bottom corners on the footer itself,
                          that's fine, but it won't visually clip to the .trivia-container corners. */
    border-bottom-left-radius: 0; /* Remove if it looks odd when fixed */
    border-bottom-right-radius: 0;/* Remove if it looks odd when fixed */

    z-index: 40; /* Needs to be above .main-content (z-index: 5)
                    but below .game-header (z-index: 9990)
                    and well below modals (z-index: 10000) */
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 60px;
}

.feedback-footer .footer-content-limiter,
.game-footer .footer-content-limiter {
    width: 100%;
    max-width: 900px; /* Match your .trivia-container max-width */
    margin: 0 auto;   /* Center the content within the full-width fixed footer */
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}


.feedback-footer { background-color: #222b38; border-top: 1px solid #f34c3e; transition: background-color 0.3s ease-in-out, border-top-color 0.3s ease-in-out; }
.feedback-footer.correct-state { background-color: #38a169 !important; border-top-color: #2c7a50 !important; }
.feedback-footer.incorrect-state { background-color: #e53e3e !important; border-top-color: #c53030 !important; }
.feedback-text { font-size: 0.9rem; font-weight: normal; text-align: center; color: #ffffff; margin-bottom: 8px; line-height: 1.4; width: 100%; max-width: calc(100% - 20px); word-wrap: break-word; box-sizing: border-box; }
.feedback-text strong { font-weight: bold; }

/* === CONSOLIDATED LINK STYLES === */
.feedback-text a.source-link { color: #fef08a !important; text-decoration: underline !important; font-weight: bold; transition: color 0.2s; }
.feedback-text a.source-link:hover { color: #ffffff !important; }
.message-box a.source-link { color: #f34c3e !important; text-decoration: underline !important; font-weight: bold; transition: color 0.2s; }
.message-box a.source-link:hover { color: #ed8936 !important; }
a.digitrendz-link-style { color: #f34c3e !important; text-decoration: underline !important; font-weight: bold; transition: color 0.2s; }
a.digitrendz-link-style:hover { color: #ed8936 !important; }
/* === END LINK STYLES === */

.next-button {
    padding: 8px 22px;
    border-radius: 7px;
    font-size: 0.9rem;
    cursor: pointer;
    transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out, border-color 0.2s ease-in-out;
    font-weight: bold;
    display: block;
    margin-top: 5px;
    flex-shrink: 0;
    text-align: center;
    /* Default border and color, background will be overridden */
    border: 2px solid transparent; /* Start with transparent border */
    color: #ffffff; /* Default white text */
}
.next-button:hover {
    background-color: #4a5568;
    border-color: #cbd5e0;
}

#main-next-button {
    background-color: #1a202c; /* Default dark background */
    color: #ffffff;
    border-color: #ffffff; /* Default white border */
}
#main-next-button:hover {
    background-color: #4a5568;
    border-color: #cbd5e0;
}

/*
   VERY SPECIFIC rules for #main-next-button when inside .feedback-footer
   /* Style for "Next Question" button when feedback is INCORRECT or TIME'S UP (RED footer) */
.feedback-footer.incorrect-state #main-next-button {
    background-color: #1a202c !important; /* Dark background */
    color: #ffffff !important;           /* White text */
    border: 2px solid #ffffff !important; /* White border */
}
.feedback-footer.incorrect-state #main-next-button:hover {
    background-color: #4a5568 !important; /* Lighter dark on hover */
    border-color: #cbd5e0 !important;
}

/* Style for "Next Question" button when feedback is CORRECT (GREEN footer) */
.feedback-footer.correct-state #main-next-button {
    background-color: #f34c3e !important; /* Orange background (like restart button) */
    color: #ffffff !important;           /* Dark text */
    border: 2px solid #f34c3e !important; /* Orange border (or #1a202c for contrast) */
    /* If using an orange border on an orange button isn't distinct enough, try: */
    /* border: 2px solid #1a202c !important; */ /* Dark border for contrast */
}
.feedback-footer.correct-state #main-next-button:hover {
    background-color: #ed8936 !important; /* Darker orange on hover */
    border-color: #ed8936 !important;     /* Darker orange border on hover */
    /* If using dark border: */
    /* border-color: #000000 !important; */ /* Or a darker shade of orange */
}


.game-footer { background-color: #2d3748; border-top: 1px solid #4a5568; }
.end-game-area { text-align: center; }
.end-game-area .question-text { font-size: 1.25rem; font-weight: bold; margin-bottom: 10px; color: #f34c3e; }
.end-game-area .score-display { font-size: 1.1rem; margin-bottom: 20px; }
/* Styles for the #restart-button (Play Again button in .game-footer) */
/* Assuming it also has class="next-button" for shared padding/font etc. */
#restart-button {
    background-color: #f34c3e; /* Orange restart button */
    color: #1a202c;           /* Dark text */
    border: 2px solid #f34c3e; /* Orange border */
}
#restart-button:hover {
    background-color: #ed8936; /* Darker orange on hover */
    border-color: #ed8936;
}

/* --- Message Box Modal --- */
.message-box { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 90%; max-width: 480px; background-color: #2d3748; border: 2px solid #f34c3e; border-radius: 8px; padding: 20px 25px; box-shadow: 0 8px 25px rgba(0,0,0,0.6); z-index: 10000; color: #e2e8f0; font-size: 1rem; text-align: center; }
/* Default state for ALL individual modal content panes: HIDDEN */
.message-box .modal-pane { /* Using the common .modal-pane class (ensure this class is on the divs in PHP) */
    display: none;
    flex-direction: column;
    align-items: center;
    width: 100%;
    gap: 15px;
}
/* Only the pane with .visible class (added by JS) will be shown */
.message-box .modal-pane.visible { /* Using the common .modal-pane class */
    display: flex !important;
}
/* Button containers for general modals */
.message-box .exit-message-content .button-container,
.message-box .level-complete-message-content .button-container,
.message-box .home-message-content .button-container,
.message-box .new-level-message-content .button-container,
.message-box .retry-level-message-content .button-container {
    display: flex; flex-direction: column; gap: 10px; width: 100%; margin-top: 10px;
}
/* Specific handling for OK button containers in load/generic info modals */
.message-box .load-message-content .button-container,
.message-box .generic-info-content .button-container { display: none !important; }
.message-box .load-message-content.visible .button-container,
.message-box .generic-info-content.visible .button-container { display: flex !important; flex-direction: column; gap: 10px; width: 100%; margin-top: 10px; }
/* General styling for text and buttons within ANY modal */
.message-box h3 { font-size: 1.4rem; font-weight: bold; color: #f34c3e; margin-bottom: 5px; font-family: "Courier New", Courier, monospace !important; }
.message-box p { line-height: 1.5; margin-bottom: 5px; max-width: 100%; }
.message-box .button-container button, .message-box .button-container a { width: 100%; padding: 10px 15px; border-radius: 5px; font-size: 0.9rem; font-weight: bold; cursor: pointer; transition: background-color 0.2s, color 0.2s, border-color 0.2s; text-align: center; text-decoration: none; box-sizing: border-box; }
.message-box .button-container button { background-color: #f34c3e; color: #1a202c; border: 1px solid #f34c3e; }
.message-box .button-container button:hover { background-color: #ed8936; border-color: #ed8936; }
.message-box .button-container #cancel-exit-button, .message-box .button-container #cancel-home-button, .message-box .button-container #retry-menu-button, .message-box .button-container #exit-without-save-button { background-color: transparent; color: #f34c3e; border: 1px solid #f34c3e; }
.message-box .button-container #cancel-exit-button:hover, .message-box .button-container #cancel-home-button:hover, .message-box .button-container #retry-menu-button:hover, .message-box .button-container #exit-without-save-button:hover { background-color: #f34c3e; color: #1a202c; }
.message-box .new-level-message-content .article-suggestion { font-size: 0.9em; color: #a0aec0; margin-top: 5px; }
.message-box .new-level-message-content #new-level-article-link { margin-top: 0; }

/* === STYLES FOR PRELOAD SCREEN & TOPIC SELECTION (Base/Desktop) === */
#preload-screen.main-content .preload-content-wrapper { display: flex; flex-direction: column; align-items: center; justify-content: space-between; width: 100%; flex-grow: 1; padding: 20px 15px; box-sizing: border-box; gap: 20px; }
#topic-selection-logo { width: 380px; max-width: 100%; height: auto; /* max-height: 240px; <-- Control with width primarily */ display: block; margin-left: auto; margin-right: auto; margin-top: 1vh; margin-bottom: 15px; }
#preload-screen .game-title { font-size: 2.5rem; margin-top: 0; margin-bottom: 25px; font-family: "Courier New", Courier, monospace !important; text-align: center; color: #ffffff; }
#preload-screen .game-title .orange-text { color: #f34c3e; }
#preload-screen #welcome-paragraph { font-size: 1.05rem; margin-top: 20px; margin-bottom: 55px; max-width: 480px; text-align: center; line-height: 1.6; }
#start-game-button { padding: 14px 35px; font-size: 1.2rem; font-weight: bold; margin-bottom: 50px; background-color: #f34c3e; color: #1a202c; border: none; border-radius: 7px; cursor: pointer; transition: background-color 0.2s, transform 0.1s; }
#start-game-button:hover { background-color: #ed8936; transform: translateY(-2px); }
#start-game-button:active { transform: translateY(0px); }
#choose-topic-heading { font-size: 1.8rem; margin-top: 10px; margin-bottom: 25px; font-family: "Courier New", Courier, monospace !important; color: #ffffff; text-align: center; }
#preload-screen #topic-options-preload { display: grid; grid-template-columns: 1fr; gap: 15px; margin-bottom: 20px; width: 100%; max-width: 450px; }
#preload-screen #topic-options-preload .option-button { padding: 15px 20px; font-size: 1rem; font-weight: bold; }
#preload-screen #topic-options-preload .option-button.explore-digitrendz-button { margin-top: 10px; }
#preload-screen .signature { font-size: 0.85rem; color: #a0aec0; padding-top: 15px; text-align: center; width: 100%; margin-top: auto; }
#preload-screen .signature a { color: #f34c3e; }
#preload-screen .digitrendz-branding { font-size: 0.75rem; color: #a0aec0; margin-top: 10px; text-align: center; }

/* --- Responsive Design Adjustments --- */

/* Medium screens (Tablets, larger phones in landscape) */
@media (min-width: 501px) and (max-width: 767px) {
    .trivia-container { width: 90%; max-width: 650px; }
    #preload-screen.main-content { padding-bottom: 60px; }
    #preload-screen.main-content .preload-content-wrapper { gap: 15px; }
    #topic-selection-logo { width: 380px; max-height: 200px; margin-bottom: 5px; }
    #preload-screen #welcome-paragraph { margin-top: 15px; margin-bottom: 25px; }
    #choose-topic-heading { font-size: 1.7rem; margin-bottom: 20px; }
    #preload-screen #topic-options-preload { max-width: 400px; gap: 12px; }
    #preload-screen .signature { padding-top: 20px; }
    #game-area .options-container { max-width: 100%; }
}

/* Large screens (Desktops) - This applies for 768px and up */
@media (min-width: 768px) {
    /* .trivia-container max-width: 900px from base rule will apply */
    .game-header { padding: 18px 25px; }
    #game-area.main-content { padding: 25px 35px; padding-bottom: 85px; }
    #preload-screen.main-content { padding: 30px 40px; padding-bottom: 75px; }
    #game-area .options-container { grid-template-columns: repeat(2, 1fr); gap: 15px; max-width: 600px; }
    #preload-screen #topic-options-preload { grid-template-columns: repeat(2, 1fr); gap: 20px; max-width: 600px; }
    .game-header .game-title { font-size: 1.45rem; }
    #game-area .question-text { font-size: 1.25rem; }
    #game-area .option-button { font-size: 0.95rem; padding: 14px 20px; }
    #preload-screen .game-title { font-size: 2.8rem; } /* Larger title on desktop preload */
    #choose-topic-heading { font-size: 2rem; margin-bottom: 20px; }
    #start-game-button { font-size: 1.3rem; }
    #preload-screen #topic-options-preload .option-button { font-size: 1.05rem; line-height: normal;padding: 16px 22px;}
    .message-box .button-container { flex-direction: row; justify-content: center; }
    .message-box .button-container button, .message-box .button-container a { width: auto; min-width: 120px; }
    .message-box .load-message-content.visible .button-container, .message-box .generic-info-content.visible .button-container { flex-direction: row; justify-content: center; }
}

/* Small screens (Mobile phones) - Primary mobile overrides */
@media (max-width: 500px) {
    .trivia-container-wrapper { padding: 0; }
   .trivia-container {
        width: 100%;
        max-width: 100%;
        min-width: 0;
        margin-left: 0;
        margin-right: 0;
        
        /* --- HEIGHT ADJUSTMENT FOR MOBILE VIEWPORT --- */
        min-height: 100dvh; /* Try Dynamic Viewport Height first */
        /* Fallbacks for browsers that might not support dvh perfectly yet */
        min-height: -webkit-fill-available; /* Common for iOS Safari */
        min-height: fill-available;         /* Emerging standard */
        min-height: stretch;                /* Another emerging standard */
        min-height: 92vh; /* Final fallback if none of the above are supported */
        /* --- END HEIGHT ADJUSTMENT --- */

        border-radius: 0;
        border-left: none;
        border-right: none;
        border-top: none;
        display: flex; /* Ensure it's a flex container for children like .preload-content-wrapper */
        flex-direction: column; /* To stack children vertically */
        overflow: hidden; /* Prevent container itself from showing scrollbars if children overflow,
                             children like .main-content should handle their own scroll if needed */
    }
    
    .game-header { padding: 10px 12px; position: sticky; top: 0; background-color: rgba(45, 55, 72, 0.95); }
    .game-header .header-top-row { flex-direction: column; align-items: center; gap: 8px; }
    .game-header .game-title-area { text-align: center; }
    .game-header .game-title { font-size: 1.2rem; }
    .game-header .signature { font-size: 0.65rem; }
    .game-header .header-buttons { margin-left: 0; width: 100%; justify-content: center; gap: 10px; }
    .game-header .header-buttons button { font-size: 0.7rem; padding: 6px 10px; }
    .header-info-bar { padding: 8px 10px; margin-top: 8px; }
    #timer-display { font-size: 1rem; padding: 5px 10px; margin-top: 6px; }
    #lifeline-5050 { padding: 5px 8px; font-size: 0.65rem; }
    .level-display, .score-display, .question-progress-display { font-size: 0.75rem; }

    .main-content { padding: 12px; padding-top: 15px; padding-bottom: 100px; }
    #game-area.main-content { padding-top: 15px; }
    #game-area #question-area { margin-top: 10px; }
    #game-area .question-text { font-size: 1.05rem; margin-bottom: 20px; line-height: 1.35; }
    #game-area .options-container { max-width: 100%; gap: 10px; }
    #game-area .option-button { font-size: 0.85rem; padding: 12px 14px; }

    .feedback-footer, .game-footer { padding: 10px 12px; min-height: 55px; }
    .feedback-text { font-size: 0.8rem; max-width: 100%; }
    .next-button { font-size: 0.8rem; padding: 8px 18px; }

    .message-box { font-size: 0.9rem; padding: 15px; width: calc(100% - 30px); }
    .message-box h3 { font-size: 1.25rem; }
    .message-box .button-container button, .message-box .button-container a { font-size: 0.85rem; padding: 10px 12px; }

    /* --- MOBILE PRELOAD & TOPIC SELECTION SCREEN - REFINED SPACING --- */
    #preload-screen.main-content { padding: 20px 15px; padding-bottom: 20px; justify-content: space-between; display: flex; flex-direction: column; }
    #preload-screen.main-content .preload-content-wrapper { padding: 10px; justify-content: center; flex-grow: 1; display: flex; flex-direction: column; align-items: center; gap: 15px; /* Allow it to take up space */
        min-height: 0; /* Prevent it from imposing its own min-height if not needed */} 
    

    #topic-selection-logo { max-width: 85%; width: auto; height: auto; max-height: 100px; margin-top: 3vh; margin-bottom: 20px; }
    #preload-screen .game-title { font-size: 1.7rem; margin-bottom: 15px; line-height: 1.1; } /* For H1 on preload */
    #preload-screen .game-title span { display: block; text-align: center; } /* To stack parts of H1 title if needed */
    #preload-screen #welcome-paragraph { font-size: 0.85rem; margin-top: 10px; margin-bottom: 20px; line-height: 1.5; }
    #start-game-button { font-size: 1rem; padding: 12px 25px; margin-bottom: 20px; }
    #choose-topic-heading { font-size: 1.4rem; margin-top: 5px; margin-bottom: 25px; color: #ffffff; font-family: "Courier New", Courier, monospace !important; text-align: center; }
    #preload-screen #topic-options-preload { gap: 15px; margin-bottom: 15px; width: 100%; max-width: 90%; }
    #preload-screen #topic-options-preload .option-button { font-size: 0.9rem; padding: 13px 15px; }
    #preload-screen #topic-options-preload .option-button.explore-digitrendz-button { margin-top: 10px; }
    #preload-screen .signature { font-size: 0.75rem; padding-top: 10px; margin-top: auto; width: 100%; text-align: center; }
}